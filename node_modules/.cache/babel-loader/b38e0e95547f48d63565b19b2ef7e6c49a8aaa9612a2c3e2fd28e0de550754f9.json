{"ast":null,"code":"import axios from \"axios\";\nconst instance = axios.create({\n  baseURL: \"http://localhost:5000/api\",\n  withCredentials: true\n});\ninstance.interceptors.request.use(config => {\n  const token = localStorage.getItem(\"token\");\n  if (token) {\n    config.headers[\"Authorization\"] = `Bearer ${token}`;\n  }\n  return config;\n});\ninstance.interceptors.request.use(config => {\n  const token = localStorage.getItem(\"token\");\n  if (token) {\n    try {\n      const payload = JSON.parse(atob(token.split(\".\")[1]));\n      const isValid = Date.now() < payload.exp * 1000;\n      if (isValid) {\n        config.headers[\"Authorization\"] = `Bearer ${token}`;\n      } else {\n        localStorage.removeItem(\"token\"); // ryd udløbet token\n      }\n    } catch (err) {\n      localStorage.removeItem(\"token\"); // ryd hvis token er korrupt\n    }\n  }\n  return config;\n});\nexport default instance;","map":{"version":3,"names":["axios","instance","create","baseURL","withCredentials","interceptors","request","use","config","token","localStorage","getItem","headers","payload","JSON","parse","atob","split","isValid","Date","now","exp","removeItem","err"],"sources":["C:/Users/danie/Documents/Projekter/nexpertia/frontend/src/utils/axiosInstance.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\nconst instance = axios.create({\r\n  baseURL: \"http://localhost:5000/api\",\r\n  withCredentials: true, \r\n});\r\n\r\ninstance.interceptors.request.use((config) => {\r\n  const token = localStorage.getItem(\"token\");\r\n  if (token) {\r\n    config.headers[\"Authorization\"] = `Bearer ${token}`;\r\n  }\r\n  return config;\r\n});\r\n\r\ninstance.interceptors.request.use((config) => {\r\n  const token = localStorage.getItem(\"token\");\r\n\r\n  if (token) {\r\n    try {\r\n      const payload = JSON.parse(atob(token.split(\".\")[1]));\r\n      const isValid = Date.now() < payload.exp * 1000;\r\n\r\n      if (isValid) {\r\n        config.headers[\"Authorization\"] = `Bearer ${token}`;\r\n      } else {\r\n        localStorage.removeItem(\"token\"); // ryd udløbet token\r\n      }\r\n    } catch (err) {\r\n      localStorage.removeItem(\"token\"); // ryd hvis token er korrupt\r\n    }\r\n  }\r\n\r\n  return config;\r\n});\r\n\r\n\r\nexport default instance;\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,QAAQ,GAAGD,KAAK,CAACE,MAAM,CAAC;EAC5BC,OAAO,EAAE,2BAA2B;EACpCC,eAAe,EAAE;AACnB,CAAC,CAAC;AAEFH,QAAQ,CAACI,YAAY,CAACC,OAAO,CAACC,GAAG,CAAEC,MAAM,IAAK;EAC5C,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C,IAAIF,KAAK,EAAE;IACTD,MAAM,CAACI,OAAO,CAAC,eAAe,CAAC,GAAG,UAAUH,KAAK,EAAE;EACrD;EACA,OAAOD,MAAM;AACf,CAAC,CAAC;AAEFP,QAAQ,CAACI,YAAY,CAACC,OAAO,CAACC,GAAG,CAAEC,MAAM,IAAK;EAC5C,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAE3C,IAAIF,KAAK,EAAE;IACT,IAAI;MACF,MAAMI,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACP,KAAK,CAACQ,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACrD,MAAMC,OAAO,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGP,OAAO,CAACQ,GAAG,GAAG,IAAI;MAE/C,IAAIH,OAAO,EAAE;QACXV,MAAM,CAACI,OAAO,CAAC,eAAe,CAAC,GAAG,UAAUH,KAAK,EAAE;MACrD,CAAC,MAAM;QACLC,YAAY,CAACY,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC;MACpC;IACF,CAAC,CAAC,OAAOC,GAAG,EAAE;MACZb,YAAY,CAACY,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC;IACpC;EACF;EAEA,OAAOd,MAAM;AACf,CAAC,CAAC;AAGF,eAAeP,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}